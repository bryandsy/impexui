<!DOCTYPE html>
<html >
    <head>
        <title>Impexui</title>
		<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
        <meta http-equiv="content-type" content="text/html;charset=utf-8">
		<script type="text/javascript" src="../../impex.all.js"></script>
		<script type="text/javascript" src="../../build/impexui.all.js"></script>
		<script type="text/javascript" src="../../src/impex.util.js"></script>
		<script type="text/javascript" src="../../src/impex.directive.js"></script>
		<script type="text/javascript" src="../../src/components/impex.form.js"></script>
		<style>
			.invalid{
				background-color:#ddd;
			}
		</style>
    </head>
    <body>
		<h3>Form表单</h3>
		<p>带校验的form表单操作。新增、重置和修改。</p>
		<fieldset>
			<legend>学生信息表单</legend>
			<br>
			<impex-form onSuccess="onSuccess" url="http://localhost/mt/test_add.do">
				学生姓名：<input id="sname" type="text" x-disabled="true" autocomplete="false" value="{{student.name}}" x-validate="required" name="student.name"/>
				<br><br>
				学生年龄：<input style="display:none;" type="text" value="{{student.age}}" name="student.age" x-validate="required"/>
				<br><br>
				学生照片：<impex-file name="photo" style="display:inline-block;"></impex-file>
				<br><br>
				入学日期：<input type="text" value="{{student.sdate}}" name="student.sdate"/>
				<br><br>
				离校日期：<input type="text" value="{{student.edate}}" name="student.edate"/>
				<br><br>
				<input type="submit" value="提交" x-disabled="invalid"/>
				<input type="button" value="重置表单" :click="reset()"/>
				<input type="button" value="编辑" :click="edit()"/>
			</impex-form>
		</fieldset>

		<script>
			// 自定义验证标签
			impex.directive("validate", {
				onCreate: function() {
				},
				
				onInit: function() {
					var that = this;
					$(this.view.el).on("input", function() {
						that.emit("validate.fire", that.do());
					});
				},
				
				do: function() {
					return this.view.el.value != "";
				}
			});

			var model = {
				onDisplay: function() {
					
				},
				events: {
					"form.success": function(com, rs) {
						console.log("form.success => " + rs);
					}
				},
				methods: {
					"onSuccess": function(rs) {
						console.log("onSuccess = >" + rs);
					}
				}
			};
			var page = impex.render(document.body, model);
		</script>
    </body>
</html>